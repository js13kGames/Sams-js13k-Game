const twoPI=2*Math.PI,friction=2;class Envelope{constructor(e,t,a,s){this.a=e,this.d=t,this.s=a,this.r=s,this.aS=e*samprate,this.dS=t*samprate,this.rS=s*samprate,this.rT=this.aS+this.dS}level(e){return e<this.aS?e/this.aS:e<this.rT?1-(1-this.s)*(e-this.aS)/this.dS:this.s*(1-(e-this.rT)/this.rS)}}class Enemy extends Moo{constructor(e,t,a,s,i){let l=1.4,n=60;"boss"==i&&(l=3,n=100),super(e,t,n,"#cc30"),this.type=i,this.lrMaxSpeed=3,this.roamCount=0,this.dashing=!1,this.currentPlatform=a,this.attackCounter=0,this.nextAttack=0,this.attackInterval=25,"boss"==i&&(this.attackInterval=12),this.facing,this.attackPower=20,this.facing="left",this.attackAnimOverTimeout,this.doneSpawning=!1,"spawner2"==i&&pnla(),"spawner"==i||"spawner2"==i?(this.model=new CoolPath(0,0,s1data,2),this.model.fuR.sai(0)):this.model=new CoolPath(0,0,edata,l),"shooter"==i&&(this.model.colors[0]="#8a8f"),"fighter"==i&&(this.model.colors[0]="#88af"),this.sIndex=s,this.spawnInterval=200,this.spawnCounter=0,this.enemyCount=0,this.nextSpawn=0,this.unlockdist=0,this.unlocked=!1,this.spawner2interval=150,this.s2t=""}updateSpawner(){0!=this.display()&&(this.model.x=this.sEE.x+20,this.model.y=this.sEE.y+20,this.model.update(ctx,!1)),this.spawnCounter++}updateSpawner2(){let e,t,a=this.display();if(0!=a){this.unlocked&&this.unlockdist<20&&(this.unlockdist+=2),ctx.save(),ctx.strokeStyle="black",ctx.lineWidth="10",ctx.translate(a.x,a.y),ctx.beginPath(),ctx.fillRect(0,0,10,-this.unlockdist),ctx.arc(30,0-this.unlockdist,25,Math.PI,0),ctx.stroke(),cRect(0,0,60,40,"blue"),cRect(3,12,54,20,"white");for(let a=0;a<rLi.length;a++)t="black","_"==(e=rLi[a])&&(e=String.fromCharCode(48+rI(74)),t="grey"),cText(e,6*a+4,25,t,12);for(let e=0;e<dataCost;e++)cFill(e<datastrip%dataCost?"white":"grey"),cRect(5*e,35,4,4);ctx.restore()}this.spawnAtInterval()}spawnAtInterval(){this.spawnCounter++,this.doneSpawning||this.spawnCounter%this.spawner2interval!=0||this.spawnOne()}spawnMore(){for(let e=0;e<3;e++)this.spawnOne()}spawnOne(){let e="fighter";Math.random()>.5&&(e="shooter"),enemies.push(new Enemy(this.x-100+rI(200),this.y-80,this.currentPlatform,this.sIndex,e))}update(){if("spawner"!=this.type){if("spawner2"==this.type)return console.log("eyy"),void this.updateSpawner2();if(this.display(),0!=this.sEE){this.attackCounter++;let e=distance(player.x,player.y,this.x,this.y);this.roam(e),"fighter"==this.type?this.fight(e):"shooter"==this.type?this.enemyShooter(e):"boss"==this.type&&(this.fight(e),this.enemyShooter(e)),this.hps<100&&(this.hps+=.2),this.model.x=this.sEE.x+20,this.model.y=this.sEE.y+20,this.model.update(ctx,"left"==this.facing)}}else this.updateSpawner()}enemyShooter(e){this.nextAttack<this.attackCounter&&e.d<200&&player.y>this.y-100&&player.y<this.y+100&&(pbLa(800,1),this.shoot(player.sEE.x,player.sEE.y,10,!0),this.animate(1),this.nextAttack=this.attackCounter+this.attackInterval,this.resetEnemyAnim())}resetEnemyAnim(){this.attackAnimOverTimeout=setTimeout(function(e){e.animate(0)},400,this)}fight(e){this.nextAttack<this.attackCounter&&e.d<30&&player.y>this.y-50&&player.y<this.y+50&&(damagePlayer(this.attackPower),this.animate(1),this.nextAttack=this.attackCounter+this.attackInterval,this.resetEnemyAnim())}dash(){this.dashing=!0,this.lrMaxSpeed=6,setTimeout(function(e){e.lrMaxSpeed=3},2e3,this),setTimeout(function(e){e.dashing=!1},4e3,this)}roam(e){this.roamCount%50==0&&(player.x<this.x?this.goLeft():this.goRight(),player.y<this.y&&(e.d<150?this.jump():!this.dashing&&e.d<200&&this.dash())),this.roamCount++}animate(e){clearTimeout(this.attackAnimOverTimeout),this.model.sai(e)}}class Item extends Moo{constructor(e,t,a,s,i){super(e,t,a,s),this.size=a,this.looted=!1,this.v=1,null!=i&&(this.poofy=!0,this.pfact=0)}update(){if(this.poofy)this.pfact++;else if(!this.looted){let e=distance(this.x,this.y,enemies[0].x,enemies[0].y);if(e.d<10)this.looted=!0,addLoot();else if(e.d<80){this.v++;let t=this.v/e.d;this.x+=t*e.adj,this.y+=t*e.opp,this.fsp=0}else this.v>1&&this.v--}let e=this.display();0!=e&&cRect(e.x,e.y,this.size,this.size,this.fill)}}class CoolPath{constructor(e,t,a,s){this.x=e,this.y=t,this.cmess,this.scale=1.5,null!=s&&(this.scale*=s),this.colors=[];for(let e=0;e<a.c.length;e++)this.colors[e]=a.c[e];this.model=a.m,this.rig=a.r,this.animations=a.a;for(let e=0;e<this.rig.length;e++)this.rig[e].isRoot&&(this.fuR=new RigShape(e,this.scale,this.model,this.rig,this.animations,this.colors));this.sai(1),this.counter=0}sai(e){this.pose=e,this.fuR.sai(e)}update(e,t){this.fuR.updateRotationValues(),ctx.translate(this.x,this.y),t&&ctx.scale(-1,1),this.fuR.display(ctx),ctx.resetTransform(),this.counter++,this.counter>this.animations[this.pose].animLength&&(this.counter=0)}}class RigShape{constructor(e,t,a,s,i,l){this.colors=l,this.rig=s,this.animations=i,this.sIndex=e,this.origin={x:s[e].origin.x*t,y:s[e].origin.y*t},this.rotation=0,this.paths=[],this.counter=0;for(let s=0;s<a.length;s++)if(a[s].shape==e){let e=a[s].origin,i=e.x*t,l=e.y*t,n=`M ${i} ${l} `,r=a[s].sgs;for(let e=0;e<r.length;e++){n+=r[e].type+" ";let a=r[e].points;for(let e=0;e<a.length;e++)n+=`${i=a[e].x*t} ${l=a[e].y*t} `}this.paths.push({path:new Path2D(n),stroke:a[s].stroke,fill:a[s].fill})}this.pins=[];for(let n=0;n<s[e].pins.length;n++){let r=s[e].pins[n];this.pins.push({shape:new RigShape(r.shape,t,a,s,i,l),x:r.x*t,y:r.y*t})}}sai(e){this.pose=e;for(let t=0;t<this.pins.length;t++)this.pins[t].shape.sai(e)}updateRotationValues(){0==this.counter?this.rotation=this.animations[this.pose].initVals[this.sIndex]:this.rotation=this.getRotFromtSP();for(let e=0;e<this.pins.length;e++)this.pins[e].shape.updateRotationValues();this.counter++,this.counter>this.animations[this.pose].animLength&&(this.counter=0)}display(e){e.save(),e.rotate(rad(this.rotation)),e.translate(-this.origin.x,-this.origin.y);for(let t=0;t<this.paths.length;t++)e.strokeStyle=this.colors[this.paths[t].stroke],e.lineWidth="2",e.stroke(this.paths[t].path);for(let t=0;t<this.pins.length;t++)e.save(),e.translate(this.pins[t].x,this.pins[t].y),this.pins[t].shape.display(e),e.restore();e.restore()}getRotFromtSP(){let e=this.animations[this.pose],t=e.tSP[this.sIndex];if(t.length>0){for(let a=0;a<t.length;a++)if(this.counter<=t[a].time){setlast(0,0);let s=t[a-1];return a>0?setlast(s.time,s.rot):setlast(0,e.initVals[this.sIndex]),this.lerprot(t[a].time,t[a].rot)}let a=last(t);return setlast(a.time,a.rot),this.lerprot(e.animLength,e.initVals[this.sIndex])}return this.animations[this.pose].initVals[this.sIndex]}lerprot(e,t){return lastp.r+(this.counter-lastp.t)/(e-lastp.t)*(t-lastp.r)}}class Moo extends DisplayObject{constructor(e,t,a,s){super(e,t,a,a),this.fill=s,this.hasGravity=!0,this.fallAcc=2,this.lrMaxSpeed=12,this.lrAcc=1,this.initjfr=25,this.mol=!1,this.mor=!1,this.jfr=0,this.jumpDecel=2.2,this.fsp=0,this.lrSpeed=0,this.imf={x:0,y:0},this.hps=100,this.jpa=!1}goLeft(){this.mor=!1,this.mol=!0,this.facing="left"}goRight(){this.mor=!0,this.mol=!1,this.facing="right"}display(){this.moveLeftRight(),this.applyPhysics();let e=this.position();return this.hps<100&&this.displayHealthBar(),e}displayHealthBar(){progressBar(this.sEE.x,this.sEE.y-35,30,10,this.hps,"red","white")}jump(){this.jfr=this.initjfr}moveLeftRight(){this.mol&&!this.mor?(this.lrSpeed-=this.lrAcc,this.lrSpeed=Math.max(this.lrSpeed,-this.lrMaxSpeed)):this.mor&&!this.mol?(this.lrSpeed+=this.lrAcc,this.lrSpeed=Math.min(this.lrSpeed,this.lrMaxSpeed)):this.lrSpeed+friction<0?this.lrSpeed+=friction:this.lrSpeed-friction>0?this.lrSpeed-=friction:this.lrSpeed=0,this.imf.x-1>0?this.imf.x--:this.imf.x+1<0?this.imf.x++:this.imf.x=0,this.x+=this.lrSpeed+this.imf.x}applyPhysics(){this.updatefsp(),this.jfr-this.jumpDecel>0?this.jfr-=this.jumpDecel:this.jfr=0,this.jpa&&(this.fsp=0),this.y+=this.fsp-this.jfr}updatefsp(){let e=l1.platforms,t=kLi;for(let a=0;a<e.length;a++)this.x>e[a].x-e[a].w2&&this.x<e[a].x+e[a].w2&&e[a].y>=this.y+this.h/2&&e[a].y<t&&(t=e[a].y,this.currentPlatform=a);this.y+this.h/2+this.fsp<t?this.fsp+=this.fallAcc:(this.y=t-this.h/2,this.imf.y=this.fsp,this.fsp=0)}}class DisplayObject{constructor(e,t,a,s){this.x=e,this.y=t,this.w=a,this.h=s,this.w2=this.w/2,this.h2=this.h/2}position(){return checkCollision(getBounds(this),camera)?this.sEE=gSP(this):this.sEE=!1,this.sEE}limitX(){this.x=Math.min(Math.max(this.x,-sw/2),sw/2)}shoot(e,t,a,s){e<this.sEE.x?this.facing="left":this.facing="right",projectiles.push(new Projectile(this.x,this.y,6,"green",a,e,t,s))}}class Projectile extends Moo{constructor(e,t,a,s,i,l,n,r){super(e,t,a,s),this.hitsplayer=r,this.destroyed=!1,this.y-=20;let o=this.position(),h=distance(o.x,o.y,l,n),c=i/h.d;this.speedVect={y:c*h.opp,x:c*h.adj},this.hasGravity=!1,this.lifeTimer=0}upj(){if(this.lifeTimer++,this.destroyed){let e=this.display();0!=e&&cRect(e.x,e.y,this.size,this.size,"white")}else{this.x+=this.speedVect.x,this.y+=this.speedVect.y,cFill("#4a8f");let e=this.position();if(this.size=10,0!=e){this.hitsplayer?checkCollision(getBounds(this),getBounds(player))&&(this.stopProjectile(),this.bump(player,8),pdfx(),damagePlayer(enemyShooterDamage)):(this.checkForCollisions(l1.platforms,!1),this.checkForCollisions(enemies,25),cFill(this.fill),this.size=4),this.checkWallCollisions();let t=this.lifeTimer%6;cRect(e.x-t,e.y-t,this.size+2*t,this.size+2*t),cRect(e.x,e.y,this.size,this.size,"white")}}}checkWallCollisions(){(this.x<-sw/2||this.x>sw/2)&&this.stopProjectile()}checkForCollisions(e,t){for(let a=0;a<e.length;a++)checkCollision(getBounds(e[a]),getBounds(this))&&(this.stopProjectile(),0!=t&&(awd("r1")&&(t*=2),"spawner"==e[a].type?(e[a].hps=0,e[a].spawnMore()):"spawner2"!=e[a].type&&(this.bump(e[a],4),e[a].hps-=t),pbLa(200,6)))}bump(e,t){e.imf.x+=Math.min(Math.max(e.x-this.x,-t),t)}stopProjectile(){this.speedVect.x=0,this.speedVect.y=0,this.destroyed=!0}}class Level{constructor(e,t,a,s){if(null!=s){let t=e[0];this.text404=new DisplayObject(t[0]-10,t[1]-10,300,300)}this.platforms=[],this.bgFill="#333F",this.txtCounter=0;for(let t=0;t<e.length;t++){let a=this.getplatformtext(e[t][2]);this.platforms.push(new Platform(e[t][0],e[t][1],e[t][2],a))}this.clouds=[],this.moreClouds(3),this.newWalls(sw),this.bgTxt=new DisplayObject(t/2,this.platforms[0].y+a,2*t,4*a),this.bgcounter=0,this.thunder=100,this.drops=[],this.cleared=!1,this.cleared2=!1}moreClouds(e){for(let t=0;t<e;t++){let e=3+rI(4),a=[];for(let t=0;t<e;t++)a.push(this.getplatformtext(30+rI(100)));let s=1;t%2==0&&(s=-1),this.clouds.push({o:new DisplayObject(0+200*t+rI(100),kLi+rI(450),1e3,1e3),t:a,n:rI(200),dir:s})}}getplatformtext(e){let t="";for(let a=0;a<e/3;a++)t+=bgText[this.txtCounter],this.txtCounter++,this.txtCounter==bgText.length&&(this.txtCounter=0);return t}as2(){let e=this.platforms[1+rI(this.platforms.length-1)];enemies.push(new Enemy(e.x,e.y-80,0,0,"spawner2")),tsg=last(enemies)}clel(){this.cleared=!0,this.bgFill="#666"}clel2(){this.cleared2=!0,this.bgFill="#ccc"}newWalls(e){this.walls=[new DisplayObject(-.75*e,0,e/2,2e3),new DisplayObject(.75*e,0,e/2,2e3),new DisplayObject(0,kLi+520,2e3,1e3)]}dbg(){if(cRect(0,0,canvas.w,canvas.h,this.bgFill),this.bgcounter>this.thunder&&!l1.cleared2){let e=10-(this.bgcounter-this.thunder);if(e>=0)cRect(0,0,canvas.w,canvas.h,"#FFF"+e);else if(Math.random()<.3)this.thunder+=50+rI(100),playThunder();else{let e=200;l1.cleared&&(e=20),this.thunder+=e+rI(e),playThunder()}}for(let e=0;e<this.clouds.length;e++){let t=this.clouds[e];if(t.o.position(),0!=t.o.sEE)for(let e=0;e<t.t.length;e++)cText(t.t[e],t.o.sEE.x*(.7+.03*e),.8*t.o.sEE.y+15*e,"#bbb3",30);t.o.x+=.2*t.dir,this.bgcounter%150==0&&Math.random()>.5&&(t.dir*=-1)}let e=this.bgTxt.position();for(let t=this.drops.length-1;t>=0;t--){let a=this.drops[t];a.y+=20,cText(bgText[a.c],e.x+a.x,e.y+a.y,"#bbba",12),a.y>player.y&&this.drops.splice(t,1)}this.bgcounter%4==0&&this.drops.push({x:player.x+rI(canvas.w),y:player.y-800,c:rI(400)}),this.bgcounter++}d4b(){let e=this.text404.position();cText("404",e.x,e.y,"black",100),cText("return to last page...",e.x,e.y+50,"black",30)}dpf(){for(let e=0;e<this.platforms.length;e++)this.platforms[e].display();cFill("black");for(let e=0;e<this.walls.length;e++){let t=this.walls[e],a=t.position();0!=a&&ctx.fillRect(a.x,a.y,t.w,t.h)}}}class Platform extends DisplayObject{constructor(e,t,a,s){super(e,t,a,platformHeight),this.fill=platformFill,this.ptext=s,console.log(s)}display(){let e=this.position();if(0!=this.sEE){ctx.strokeStyle="#a438",ctx.strokeRect(e.x,e.y,this.w,20);let t=this.ptext.length;cText(this.ptext.substring(0,t/2),e.x,e.y+8,this.fill,10),cText(this.ptext.substring(t/2,t),e.x,e.y+18,this.fill,10)}}}let aContext,samprate,cash2timeout,ctx,tsg,aboutguy,atT,player,pmV,fuelregen,amnoregen,lastp,riglength,pMo,monsterModel,aboutModel,canvasElw,canvasElh,addbar,textform,listform,lda,blingInt,fav,l1,bgText,startSound=()=>{window.AudioContext=window.AudioContext||window.webkitAudioContext,aContext=new AudioContext,samprate=aContext.sampleRate},preloadSound=(e,t,a,s,i)=>{let l=[],n=samprate*(t.a+t.d+t.r),r=samprate/e,o=flo(r)*a,h=r/twoPI,c=[];if(null==i){for(let e=0;e<o;e++)c.push(s(e,h));for(let e=0;e<n;e++)l[e]=.4*t.level(e)*c[e%o]}else for(let e=0;e<n;e++)l[e]=.4*t.level(e)*s(e,h+e*i);return l},playSound=(e,t,a,s,i)=>{let l=new Float32Array(e.length);for(var n=0;n<e.length;n++)l[n]=t*e[n];let r=aContext.createBuffer(1,l.length,samprate);r.copyToChannel(l,0);let o=aContext.createBufferSource();o.buffer=r;let h=aContext.createBiquadFilter();o.connect(h),h.connect(aContext.destination),o.start(0),h.type=a,h.frequency.value=s,h.gain.value=i},bar=1800,maxbars=16,startBeatMachine=()=>setInterval(newbar,bar),bassnote="0",mel2="HJMOMPOPOJMOP",mel1="POMJHHHJMHH",mel=mel1,beatinput=[{vals:" x x x x",beatval:8,f:playHats,p:!0},{vals:"x x",beatval:16,f:playKick,v:600,p:!0},{vals:"     x",beatval:8,f:playSnare,p:!0},{vals:" 5",beatval:8,f:playWobbleBass,v:2e3,p:!0},{vals:"  ",beatval:8,f:playNoiseySynth,v:0,p:!0},{vals:"  M  K  R  P  M  P",beatval:16,f:playSine,v:0,p:!0},{vals:"  P  P  T  R  P  R",beatval:16,f:playSine,v:0,p:!0},{vals:"  R  T  W  T  R  T",beatval:17,f:playSine,v:0,p:!0}],bars=0,section=0,noteToFreq=e=>13.75*2**((e-9)/12),melCounter=0,melCount2=1,newbar=()=>{bars%4==0&&(wubfact2=100+rI(200),beatinput[7].beatval=16+rI(2),beatinput[6].beatval=16+rI(3)),"home"!=currentLevel&&lda&&!lda.cleared?(bars%8==0&&(mel!=mel1?(mel=mel1,beatinput[3].vals=" 5"):(mel=mel2,beatinput[3].vals=" 0"),melCount2=1,melCounter=0),beatinput[4].vals="   "+mel[melCounter]+" "+mel[melCounter],++melCounter>=melCount2&&(melCounter=0,melCount2++),melCount2>=mel.length&&(melCount2=0)):(beatinput[4].vals="",beatinput[3].vals="");for(let e=0;e<beatinput.length;e++)if(beatinput[e].p)for(let t=0;t<beatinput[e].vals.length;t++)"x"==beatinput[e].vals[t]?null!=beatinput[e].v?setTimeout(function(e,t){e(t)},t*bar/beatinput[e].beatval,beatinput[e].f,beatinput[e].v):setTimeout(function(e){e()},t*bar/beatinput[e].beatval,beatinput[e].f):null!=beatinput[e].v&&" "!=beatinput[e].vals[t]&&setTimeout(function(e,t){e(t)},t*bar/beatinput[e].beatval,beatinput[e].f,noteToFreq(beatinput[e].vals.charCodeAt(t)-20));++bars==maxbars&&(bars=0,section++)},sine4counter=0,sine4fact=.1,constSineB=(e,t)=>constrain(Math.round(Math.sin(e/(t+e/100))),0,.1),constSineB2=(e,t)=>constrain(Math.round(Math.sin(e/(t+e/1e3))),0,.1),noisey=(e,t)=>.02*Math.random(),noisey2=(e,t)=>Math.random()*constrain(Math.round(Math.sin(e/(e+t))),0,.13),constSine=(e,t)=>constrain(Math.sin(e/t),-.8,.8),wubfact2=200,constSine2=(e,t)=>constrain(.5*(Math.sin(e/t)+Math.sin(e/(wubfact2+t))),0,.1),constSine3=(e,t)=>constrain(.2*Math.random()*(Math.sin(e/t)+Math.sin(e/(100+t))),0,.1),constSine5=(e,t)=>constrain(.2*Math.random()*(Math.sin(e/t)+Math.sin(e/(1e3+t))),0,.1),constSine4=(e,t)=>constrain(Math.random()*sine4fact+.3*(Math.sin(e/t)+.3*Math.sin(e/(2+t))),0,.1),snarerelease=.3,playSnare=()=>play(10,.02,.01,.4,snarerelease,4,noisey2,5,"highpass",1200,4),pca=()=>{play(1600,.01,.02,.3,.6,2,constSine2,4,"lowpass",1200,2),clearTimeout(cash2timeout),cash2timeout=setTimeout(function(){play(2400,.01,.02,.3,.6,2,constSine2,4,"lowpass",1800,2)},260)},play=(e,t,a,s,i,l,n,r,o,h,c,p)=>{playSound(preloadSound(e,new Envelope(t,a,s,i),l,n,p),r,o,h,c)},playHats=()=>play(40,.01,.01,.5,.8,40,noisey,14,"highpass",6400,6),constSineZ=(e,t)=>constrain(.1*Math.random()+.8*Math.sin(e/(.2*e+t)),0,.6),pho=e=>play(e,.01,.11,.3,.31,10,constSine2,8,"highpass",500,2,-.001),pho2=()=>play(200,.01,.11,.3,.31,200,constSineZ,9,"highshelf",1500,2),wubfactor=250,playWobbleBass=e=>play(e,.05,.51,.8,1.41,4,constSine,3.6,"lowpass",wubfactor,10),playNoiseySynth=e=>{play(e,.01,.11,.3,1.45,50,constSine4,8.5,"lowpass",1500,8),++sine4counter%12==0&&(sine4fact=1-sine4fact)},playHardHat=()=>play(8,.01,.01,.11,.13,1,constSine3,6,"lowshelf",2240,12),playKick=e=>play(e,.01,.11,.3,.35,500,constSineB,16,"lowpass",180,12),pbLa=(e,t)=>play(e,.01,.11,.3,.25,100,constSineB2,t,"highpass",1080,8),playSine=e=>{if("home"!=currentLevel){let t=.15;lda&&lda.cleared&&(t=.8),play(e,.01,.11,.3,t,1,constSine,.7,"highpass",600,1)}},pdfx=()=>play(20,.01,.11,.3,.31,60+rI(20),constSine3,14,"highshelf",1500,2),playThunder=()=>play(15+rI(85),.3,.61,.3,2.81,20+rI(50),constSine5,4,"lowpass",300+rI(2200),2),canvas={},camera={},setupCamera=()=>{camera.target={x:player.x,y:player.y},camera.w=canvas.w2,camera.h=canvas.h2,camera.speed=24},cameraFollow=(e,t)=>{t-=50,reach(camera.target,{x:e,y:t},camera.speed),camera.left=camera.target.x-camera.w,camera.right=camera.target.x+camera.w,camera.top=camera.target.y-camera.h,camera.bottom=camera.target.y+camera.h},firstEnemyKilled=!1,enemyUpdateCounter=0,maxEnemies=3,enemyShooterDamage=10,een=()=>{if("home"!=currentLevel&&"start"!=currentLevel)for(let e=enemies.length-1;e>=0;e--)enemies[e].update(),enemies[e].limitX(),enemies[e].hps<=0&&(directorylevels.includes(currentLevel)?1==enemies.length?lda.sections<lda.didi?(lda.sections++,cnL(!0)):l1.cleared||(lda.cleared=!0,l1.clel(),l1.as2(),ufa()):l1.cleared&&!l1.cleared2&&gloo(enemies[e]):(l1.clel(),lda.cleared=!0,sad.bpg++,ufa()),poof(enemies[e].x,enemies[e].y,[enemies[e].model.colors[0]]),enemies.splice(e,1))},poof=(e,t,a)=>gloo({x:e,y:t},!0,a),createFriendlyNPCs=()=>{let e=l1.platforms[l1.platforms.length-1];aboutguy=new Moo(e.x+150,e.y-30,20,nocolor)},las=!1,agTing=!1,rfn=()=>{aboutguy.display(),eit(aboutguy,"press E",80),0!=aboutguy.sEE&&(aboutModel.x=aboutguy.sEE.x+8,aboutModel.y=aboutguy.sEE.y-4,aboutModel.update(ctx,!1),!dUI.open&&las?agTing=!1:dUI.open&&!las&&(agTing=!0,agT())),las=dUI.open},aTCo=8,agT=()=>{let e=60+rI(140),t=void 0,a=1200,s=400+rI(50);Math.random()<.8&&(t=-1e-4*rI(50),a=200),Math.random()<.8&&play(s,.01*rI(3),.11,.3,e/1100,10,constSine3,4,"highpass",a,3,t),aTCo--,agTing&&aTCo>0?(aboutModel.fuR.sai(1),atT=setTimeout(agT,e)):aboutModel.fuR.sai(0)},eit=(e,t,a)=>{if(0!=e.sEE){if(distance(player.x,player.y,e.x,e.y).d<a){e.itr=!0;let a=e.sEE;ctx.fillText(t,a.x+25,a.y-40,"black",10)}else e.itr=!1}else e.itr=!1},cpy=()=>{let e=l1.platforms[l1.platforms.length-1];"home"==currentLevel?e=l1.platforms[0]:e.x-=130,(player=new Moo(e.x,e.y-100,50,"#2a20")).initjfr=40,player.facing="left",player.jetFuel=100,player.gunPower=100,setupCamera(),player.display()},lastpmVState=!1,pju=!1,fuelcost=7,sct=38,mcounter=0,wcounter=0,dY=0,updatePlayer=()=>{if(player.limitX(),player.jpa&&player.jfr<10?player.jetFuel>=fuelcost?(player.jetFuel-=fuelcost,player.jfr=10):(cjp=!0,setTimeout(function(){cjp=!1},500),player.jpa=!1):player.jfr>0?player.jfr-=4:player.jfr=0,player.display(),pmV=!1,(player.mol||player.mor)&&(pmV=!0),dY=0,pmV&&0==player.jfr&&0==player.fsp){let e=Math.cos(mcounter);dY=2+e*e*7,mcounter+=.2*Math.PI,wcounter++}(pmV||wcounter%5!=0)&&++wcounter%5==0&&0==player.jfr&&0==player.fsp&&pho2(),pMo.x=player.sEE.x+20,pMo.y=player.sEE.y+14-dY,(player.jfr>0||player.fsp>0)&&!pju?(pju=!0,pMo.fuR.sai(5)):0==player.jfr&&0==player.fsp&&pju?(pju=!1,rpla()):pmV&&!lastpmVState?rpla():!pmV&&lastpmVState&&(rpla(),pho2()),lastpmVState=pmV,pMo.update(ctx,"left"==player.facing),player.hps<100&&(player.hps+=.1),player.hps<=0&&(lhl(),fade(60,"ouchies")),amnoregen=awd("r3")?3:2,player.gunPower=Math.min(player.gunPower+amnoregen,100),fuelregen=awd("r2")?3:2,cjp||(player.jetFuel=Math.min(player.jetFuel+fuelregen,100))},rpla=()=>{player.jfr>0||player.fsp>0?pMo.fuR.sai(4):pmV?pMo.fuR.sai(2):pMo.fuR.sai(0)},damagePlayer=e=>{awd("r4")&&(e*=.6),player.hps-=e,pdfx(),pMo.sai(4),setTimeout(function(){rpla()},400)},texts=["Hmm? # Oh! You must be from the cleaning service. # Thank goodness you're here. # Our web page is being attacked by a mysterious virus! # Our pages have been replaced by fake 404s full of monsters. # Yuck! It's revolting! Here, let me add our directory to your favorites.","what's up ","hey","dope","wee! you cleared a page, good job. see how it was added to your favorites. now go clean more!","that's 2 pages! nice job dude. here's a boost for your gun damage","that's 4 pages! nice job dude. here's a boost for your jump power","that's 6 pages! nice job dude. here's a boost for your amno","almost there guy! go to those boss files and rek whatever creature you might find!","wow you killed a boss dude heres a boost to your health","wow thats the second and last boss gj dude u done","thanks for playing sam thanks you now play more","haha yaa go champ","you want a tip # ... # get a job","sup"],dUI={open:!1,t:0,counter:0,line:[],lineI:0,dTt:""},dialogDone=!1,mCP=20,runDialog=()=>{if(dUI.open){if(0!=dUI.t){let e=gSP({x:dUI.t.x,y:dUI.t.y,w2:50,h2:50});dUI.x=e.x-50,dUI.y=e.y-110}cFill("white"),cRect(dUI.x,dUI.y,250,50),cFill("black"),cFont(20),cText(dUI.dTt[0],dUI.x+5,dUI.y+20),cText(dUI.dTt[1],dUI.x+5,dUI.y+40)}aboutguy.itr||(dUI.open=!1)},codi=()=>{if(dialogDone){dUI.open=!1,dialogDone=!1;let e=sad.gAP;switch(sad.tpG){case 0:for(let e=0;e<2;e++)newLevel(allLinkNames[e]);ufa(),e.push("start")}}else ctd()},ctd=()=>{let e=makeLine(),t={t:""};e.stop||(t=makeLine()),dUI.dTt=[e.t,t.t]},makeLine=()=>{let e="",t=!1,a=!1;for(;!t&&!a&&e.length+dUI.line[0].length<mCP;)"#"==dUI.line[0]?a=!0:e+=dUI.line[0]+" ",dUI.line.shift(),0==dUI.line.length&&(t=!0,dialogDone=!0);return{t:e,stop:t}},abut=()=>{"home"==currentLevel&&aboutguy.itr&&(dUI.open?codi():(dUI.open=!0,dUI.t=aboutguy,pdi(),dUI.line=texts[sad.tpG].split(" "),rLi.includes("_")||pnla(),ctd()),aTCo=6+rI(9),clearTimeout(atT),agT())},pdi=()=>{let e=sad.gAP,t=sad.dPO,a=sad.bpg,s=!1,i=0;awd("start")&&(0==a&&0==a?i=1+rI(3):a>0&&(awd("r4")?a>1?i=10:1==a?s=!0:i=11:(e.push("r4"),i=9)),(t>0||s)&&(1==t?i=4:t>1&&!awd("r1")?(e.push("r1"),i=5):t>3&&!awd("r2")?(e.push("r2"),i=6):t>5&&!awd("r3")?(e.push("r3"),i=7):i=7==t?8:12+rI(3))),sad.tpG=i},awd=e=>sad.gAP.includes(e),cantGoDown=!1,cjp=!1,jkp=!1,keypress=()=>{if(!tFormSelected)switch(event.keyCode){case 65:player.goLeft();break;case 68:player.goRight();break;case 32:jkp||(jkp=!0,!player.jpa&&player.jfr<8&&player.fsp<4&&(pho(300),player.jump()),cjp||(player.jpa=!0));break;case 83:player.y<kLi&&!cantGoDown&&player.y++;break;case 69:abut();break;case 27:dUI.open=!1}},keyrelease=()=>{if(!tFormSelected)switch(event.keyCode){case 65:player.mol=!1;break;case 68:player.mor=!1;break;case 32:player.jpa=!1,jkp=!1}},mip=!1,mouseX=0,mouseY=0,cantShoot=!1,mousePressed=()=>{mip=!0,mouseX=event.clientX-canvas.x,mouseY=event.clientY-canvas.y,"start"!=currentLevel&&!cantShoot&&player.gunPower>=sct&&(player.gunPower-=sct,pbLa(1800,3),player.shoot(mouseX,mouseY,25,!1),player.mor||player.mol?pMo.sai(3):pMo.sai(1),cantShoot=!0,setTimeout(function(){rpla(),cantShoot=!1},250))},mouseReleased=()=>mip=!1,datastrip=0,addLoot=()=>{tsg.doneSpawning||(updateInv(++datastrip),pca(),datastrip>dataCost&&(datastrip-=dataCost,processDataStrips(),updateInv(datastrip)))},updateInv=e=>{tsg.s2t=rLi},items=[],gloo=(e,t,a)=>{let s=5+rI(15),i="grey";for(let l=0;l<s;l++){null!=a&&(i=a[rI(a.length)]),null!=t?items.push(new Item(e.x,e.y-50,8,i,!0)):items.push(new Item(e.x,e.y-50,10,i));let s=items[items.length-1];s.imf.x=6+rI(12),Math.random()>.5&&(s.imf.x*=-1),s.initjfr=11,s.jump()}},updateItems=()=>{for(let e=items.length-1;e>=0;e--)items[e].update(),(items[e].looted||items[e].poofy&&items[e].pfact>30)&&items.splice(e,1)},ns1=58,ns2=93,setlast=(e,t)=>lastp={t:e,r:t},cmess="",sgs=[],newSeg=(e,t,a)=>sgs.push({type:e,points:[{x:toNum(t,a),y:toNum(t+1,a)}]}),toNum=(e,t)=>cmess.charCodeAt(e)-t,isns1=(e,t)=>e.charCodeAt(t)<ns2,toAngle=e=>180*toNum(e,ns2)/30,umm=e=>{let t=e.split("*"),a=[];sgs=[];for(let e=0;e<t.length;e++){cmess=t[e],sgs=[];for(let a=5;a<t[e].length;a+=2)if(toNum(a,0)<ns2)newSeg("L",a,ns1);else{let e=sgs.length-1;if(e>=0){let t=sgs[e],s=t.points;"L"==t.type?newSeg("C",a,ns2):s.length<3?s.push({x:toNum(a,ns2),y:toNum(a+1,ns2)}):newSeg("C",a,ns2)}else newSeg("C",a,ns2)}let s=toNum(2,ns1);s>99&&(s/=100),a.push({shape:toNum(0,ns1),fill:toNum(1,ns1),stroke:s,origin:{x:toNum(3,ns1),y:toNum(4,ns1)},sgs:sgs})}return a},apr=e=>{let t=[],a=e;cmess=a;let s=0;for(let e=0;e<a.length;e++){let i=t[t.length-1];if(0==s)t.push({origin:{x:toNum(e,ns1)},pins:[],isRoot:!1});else if(1==s)i.origin.y=toNum(e,ns1);else if(s>2){let t=i.pins[i.pins.length-1];s%3==0?i.pins.push({x:toNum(e,ns2)}):s%3==1?i.pins[i.pins.length-1].y=toNum(e,ns2):t.shape=toNum(e,ns2)}else 2==s&&"1"==a[e]&&(i.isRoot=!0);++s>2&&isns1(a,e+1)&&(s=0)}return riglength=t.length,t},una=e=>{let t=[];cmess=e;let a=e,s=!1,i=0;for(;!s;){let e=a.indexOf("*",i+1),l={name:a.substring(i+1,e)};l.animLength=toNum(e+1,ns1);let n=e+1+riglength;l.initVals=[],l.tSP=[];for(let t=e+2;t<n+1;t++)l.initVals.push(toAngle(t));i=n+1;for(let e=0;e<riglength;e++){l.tSP.push([]);let e=a.indexOf("*",i+1);-1==e&&(e=a.length,s=!0);let t=0;for(let a=i+1;a<e;a++){let e=l.tSP[l.tSP.length-1];t%2==0?e.push({rot:toAngle(a)}):e[e.length-1].time=toNum(a,ns1),t++}i=e}t.push(l)}return t},nocolor="#0000",edata={m:umm(":;:HVDOhgkaskooniqikklinf*;;:AETMQOQL*<;:AGOMOKML*=;:FAHJEOIP*>;:FAHJEOIP"),r:apr("GQ1im^in_jx`kxaAE0AG0FA0FA0"),a:una("*run*F^]]hQ*\\@*[@*[@*R@*j@*eat*F]]]iS*W<\\@*X<]@TB*c<]@eB*Q@*j@*fall*PbZ^QP*_C*YC*ZC*QC*TC"),c:["#eccf",nocolor]},abdata={m:umm(":;:GRKPCI*;;:LAJEJIHI*<;:LAJEJIHI*=;:AOLK*>;:BBMI*?;:OHBDechdghidkeji*@;:BEOI"),r:apr("GR1ku^iu_fl`LA0LA0AO0onaMI0eebeecBD0BD0"),a:una("*still*PVcgd]WX*[D*]D*dD*YD*eD*QD*YD*talk*FZadcZXX*XC*aC*fC*a>c@eC*]>Z@\\C*R>W@SC*\\>W@[C"),c:["#ada",nocolor]},s1data={m:umm(":;:SDH<>CHKSDSPHX>P>JHRSKNNNGC?M@CGCT>P>C*;;:HDHL*<;:KJFE*<;<GDibbhhi*<;<LItmosmn"),r:apr("HL0HE1ki]kg_HH0"),a:una("*ya*J]]]*[D**yB*"),c:["#dcd",nocolor,"rgba(174,44,0,1.0)"]},pdata={m:umm(":;ŦBALDnjijlfhifhhe*;;<FGJH*<;<FHJI*:;>GJfoblfe*=;>GOFJGB*>;>EFH@*?;ĂEFGM*@;>EFH@*A;ĂEFGM*B;ĂHEJLIOMO*C;ĂHEJLIOMO*D;ŦFNJLHNHKNS"),r:apr("DH0ij^ik_FG0FH0FJ1kc]geamfchpekpfH@0hibEF0H@0hidEF0jpgHE0HE0GM0"),a:una("*still*PZ]]]X]XS]]W*]E*YH*^H**ZE*YE*ZE*****shoot*B]]]]a[N_]]`*_<*W>*`>*[<*j<*]<*N<*[<*e<*`<*V<*run*D\\]]]e]TPhW_*Y?***^?*O?*T?*e?*`?*T?*i?*R?*runshot*D]]]]h]LdiU]****Y?*N?**P?*S?*W?*m?**gethit*JS]]bd^mdmH]*I=*W=*b=**M=*Y=*@=WA*U=JA*p=MA*a=_A**jump*V]]]`_a`V[Z]*[?***c?*M?*W?*G?**M?*L?*\\?"),c:["rgba(0,0,0,1.0)",nocolor,"rgba(249,79,0,1.0)","rgba(138,131,248,1.0)","rgba(247,185,0,1.0)"]},loadModelData=()=>{(pMo=new CoolPath(0,0,pdata,1.5)).sai(1),(aboutModel=new CoolPath(0,0,abdata,2)).sai(0)},projectiles=[],upjs=()=>{for(let e=projectiles.length-1;e>=0;e--)projectiles[e].upj(),projectiles[e].lifeTimer>50&&projectiles.splice(e,1)},sad=null,loadSave=()=>{null==(sad=JSON.parse(localStorage.getItem(sadHeader)))?ngS():console.log("Loaded Save")},ngS=()=>{console.log("new save"),sad={levels:[],tpG:0,dPO:0,bpg:0,gAP:[]}},sadHeader="sams404gameforjs13kof2020",saveGame=()=>localStorage.setItem(sadHeader,JSON.stringify(sad)),createCanvas=()=>{canvas.w=800,canvas.h=600,canvas.w2=canvas.w/2,canvas.h2=canvas.h/2,canvas.c=document.createElement("canvas"),canvas.c.setAttribute("width",canvas.w),canvas.c.setAttribute("height",canvas.h),(ctx=canvas.c.getContext("2d")).filter="contrast(1.5) drop-shadow(1px 1px 2px #000)"},seedL=100,maxchar=100,charStart=128,ncount=0,random=()=>{let e=noiz(flo(ncount+=.7),currentLevel);return ncount%1*(noiz(Math.ceil(ncount),currentLevel)-e)+e},noiz=(e,t)=>(lda.seedData.charCodeAt(e%seedL)-charStart)/maxchar,setupRandomSeed=e=>{let t="";for(let e=0;e<seedL;e++)t+=String.fromCharCode(charStart+rI(maxchar));return t},constrain=(e,t,a)=>Math.min(Math.max(e,t),a),checkCollision=(e,t)=>odi(e.left,e.right,t.left,t.right)&&odi(e.top,e.bottom,t.top,t.bottom),odi=(e,t,a,s)=>t>=a&&t<=s||e>=a&&e<=s||e<=a&&t>=s,gSP=e=>({x:canvas.w2+e.x-camera.target.x-e.w2,y:canvas.h2+e.y-camera.target.y-e.h2}),progressBar=(e,t,a,s,i,l,n)=>{cFill(n),cRect(e,t,a,s),cFill(l),cRect(e,t,a*i/100,s)},distance=(e,t,a,s)=>{let i=a-e,l=s-t;return{d:Math.sqrt(i*i+l*l),adj:i,opp:l}},getBounds=e=>({left:e.x-e.w2,right:e.x+e.w2,top:e.y-e.h2,bottom:e.y+e.h2}),div=(e,t)=>{let a=document.createElement("div");return document.body.appendChild(a),null!=e&&setStyle(a,e,t),a},setStyle=(e,t,a)=>e.setAttribute("style",`position:fixed; left:${t.x}px;top:${t.y}px;width:${t.w}px;height:${t.h}px;background-color:${a};`),rad=e=>e*Math.PI/180,l=e=>e.length,rI=e=>flo(Math.random()*e),flo=e=>Math.floor(e),reach=(e,t,a)=>{let s=!1,i=!1;return e.x+a<t.x?e.x+=a:e.x-a>t.x?e.x-=a:(e.x=t.x,s=!0),e.y+a<t.y?e.y+=a:e.y-a>t.y?e.y-=a:(e.y=t.y,i=!0),!(!s||!i)},last=e=>e[e.length-1],isLevel=e=>{let t=sad.levels;for(let a=0;a<t.length;a++)if(t[a].name==e)return a;return-1},pointTo=e=>document.getElementById(e),cFill=e=>{ctx.fillStyle=e},cText=(e,t,a,s,i)=>{s&&cFill(s),i&&cFont(i),ctx.fillText(e,t,a)},cFont=e=>{ctx.font=e+"px Courier New"},cRect=(e,t,a,s,i)=>{i&&cFill(i),ctx.fillRect(e,t,a,s)},waittime=5,runFadeIn=()=>{let e=1;fadeIn>waittime&&(e=1-(fadeIn-waittime)/30),e>0&&(cRect(0,0,canvas.w,canvas.h,"rgba(0,0,0,"+e+")"),cText(fadetxt,canvas.w/2-30,canvas.h/2-2,"white",20)),fadeIn++},fadetxt="",fade=(e,t)=>{fadeIn=0,waittime=e,fadetxt=null!=t?t:""},addressbar=()=>{let e=(addbar=div()).style;e.width=canvas.w+"px",e.backgroundColor="grey",e.display="flex",e.flexDirection="row",e.justifyContent="space-around",ufa(),document.body.appendChild(canvas.c);let t=canvas.c.getBoundingClientRect();canvas.x=Math.round(t.x),canvas.y=Math.round(t.y)},stpl=()=>{let e=isLevel(currentLevel);-1!=e?lda=sad.levels[e]:(newLevel(dif),lda=last(sad.levels))},dif=0,newLevel=e=>{blingFavorites(),0!=lvlCount&&lvlCount%lvlDiffIncreaseInterval==0&&(dif=Math.min(enemydidi+1,maxEnemydidi)),lvlCount++,null==e&&(e=currentlevel),sad.levels.push({name:e,seedData:setupRandomSeed(),didi:1+flo(lvlCount/2),cleared:!1,cleared2:!1,sections:0})},sld=()=>{if("home"!=currentLevel&&"start"!=currentLevel){let e=isLevel(currentLevel);sad.levels[e].cleared=lda.cleared,sad.levels[e].cleared2=lda.cleared2,sad.levels[e].sections=lda.sections}},goToLink=()=>{let e=listform.value;return"home"==e?(lhl(),void ufa()):"start"==currentLevel&&"new"==e?(ngS(),lhl(),void ufa()):void(0!=sad.levels.length&&(null!=lda&&sld(),currentLevel=e.substring(0,e.indexOf(" ")),fade(24),stpl(),createLevel(),cpy()))},lhl=()=>{currentLevel="home",createLevel(),cpy(),fade(8)},directorylevels=["submit","entries","partners","experts","prizes","rules","blog"],allLinkNames=["submit","blog","entries","partners","experts","prizes","rules","evilbot","invaderz"],nextLink="",rLi="",revealedChars=0,dataCost=10,processDataStrips=()=>{let e=rLi.length,t=rI(e);for(;"_"!=rLi[t];)t=rI(e);rLi=t<nextLink.length-1?rSub(0,t)+nextLink[t]+rSub(t+1,e):rSub(0,t)+nextLink[t],++revealedChars==e&&(newLevel(nextLink),enemies[0].unlocked=!0,l1.clel2(),lda.cleared2=!0,sad.dPO++,tsg.doneSpawning=!0,ufa())},rSub=(e,t)=>rLi.substring(e,t),lco=1,pnla=()=>{nextLink=allLinkNames[lco],lco++,rLi="",revealedChars=0;for(let e=0;e<nextLink.length;e++)rLi+="_"},startTxt=["sam's js13k","2020 game","pick 'home'","to continue","or pick 'new'","to start a new game.","then press go!!","CONTROLS","Left: A. Right: D. Down: S.","Jump: Space.","Shoot: Click. ","Talk to the home page guy: E."],sCol=["#eee","#88b","#ec1","#e32","#6a7"],scI=[0,0,1,1,2,2,3,4,4,4,4,4],sframe=0,displayStartUI=()=>{if(sframe%30==0){cRect(0,0,canvas.w,canvas.h,"#333");let e,t,a,s,i=0;for(t=0;t<startTxt.length;t++){for(s=3+rI(4),e=50-5*t,a=0;a<s;a++)cText(startTxt[t],50-a,100+i-a,sCol[scI[t]],90-6*t);i+=.7*(90-6*t)}}sframe++},tFormSelected=!1,haClass='class="hov abel"',aClass="class='abel'",ufa=()=>{eType="option";let e=sad.levels,t="favorites",a=el("home");if("start"==currentLevel)a+=el("new");else for(let t=0;t<e.length;t++)a+=el(`${e[t].name} didi: ${e[t].didi}`);eType="span",addbar.innerHTML=el(el("<",haClass)+el(">",haClass))+el(`www.coolsite.com/${currentLevel}`,aClass)+el(`${t}:<select id="${t}" style='cursor:pointer;'> ${a} </select>`+el("go",haClass+" onclick='goToLink()'"),aClass+" id='favs'"),listform=pointTo(t),fav=pointTo("favs"),saveGame()},eType="option",el=(e,t)=>(null==t&&(t=""),`<${eType} ${t}>${e}</${eType}>`),favBling=0,blinging=!1,blingFavorites=()=>{blinging||(blinging=!0,pca(),blingInt=setInterval(function(){fav=pointTo("favs"),favBG(favBling%2==0?"blue":"white"),favBling++},400),setTimeout(function(){favBG("white"),clearInterval(blingInt),blinging=!1},5e3))},favBG=e=>fav.style.backgroundColor=e,kLi=500,sw=0,fadeIn=0,enemies=[],lvlCount=0,enemydidi=1,lvlDiffIncreaseInterval=3,maxEnemydidi=3,bgurl="js/characters/enemyclass.js",basicLevel=e=>{sw=canvas.w,l1=new Level([[50,kLi-100,100],[-60,kLi-60,100],[0,kLi,canvas.w]],sw,100,e)},cnL=e=>{let t=[[0,kLi+=500,sw]],a=flo(3+3*random()),s=flo(1+3*random());for(let i=0;i<s;i++){let l=-s/3*canvas.w+i*sw/s+75,n=kLi;for(let s=0;s<a;s++){let i=50;n-=60,s==a-1&&(i=250,e&&enemies.push(new Enemy(l,n-80,0,0,"spawner"))),t.push([l,n,i+50*random()]),l+=80*random()-40}}for(let e=0;e<t.length;e++){let a=l1.getplatformtext(t[e][2]);l1.platforms.push(new Platform(t[e][0],t[e][1],t[e][2],a))}l1.moreClouds(2),l1.newWalls(sw)},createLevel=()=>{if(enemies=[],items=[],kLi=500,ncount=0,dUI.open=!1,"home"==currentLevel)basicLevel(),createFriendlyNPCs();else if(directorylevels.includes(currentLevel)){sw=2*canvas.w;let e=(l1=new Level([[0,kLi,sw]],sw,400,!0)).platforms[0],t=lda.sections;if(lda.cleared&&l1.clel(),0==t)enemies.push(new Enemy(e.x,e.y-80,0,0,"spawner"));else for(let e=0;e<t;e++)cnL(e==t-1&&!lda.cleared);lda.cleared2?l1.clel2():lda.cleared&&l1.as2(),ufa()}else{basicLevel(!0);let e=l1.platforms[0];lda.cleared?l1.clel():enemies.push(new Enemy(e.x,e.y-80,0,0,"boss"))}},platformHeight=10,platformFill="#a43f",start=()=>{loadSave(),fadeIn=0,createCanvas(),addressbar(),loadModelData(),startSound(),fetch(bgurl).then(e=>e.text()).then(e=>bgText=e.replace(" ","")),setInterval(run,33)},currentLevel="start",run=()=>{if("start"!=currentLevel){let e="home"==currentLevel;cameraFollow(player.x,player.y),l1.dbg(),e||l1.d4b(),l1.dpf(),e&&rfn(),een(),updatePlayer(),upjs(),runDialog(),updateItems(),runFadeIn(),progressBar(10,canvas.h-40,100,30,player.gunPower,"orange","grey"),progressBar(canvas.w-110,canvas.h-40,100,30,player.jetFuel,"blue","grey")}else displayStartUI()};window.onload=start,window.onbeforeunload=saveGame;
